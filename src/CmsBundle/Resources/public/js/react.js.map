{"version":3,"sources":["expression-engine.js"],"names":[],"mappings":"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","file":"react.js","sourcesContent":["// A single expression\nvar Expression = React.createClass({\n    initializeJquery: function() {\n        var expression = this.props.expression;\n        var prototype = this.props.prototypes.filter(function(item) {\n            return expression.key == item.key;\n        })[0];\n\n        var self = this;\n\n        if (prototype && prototype.type == 'date') {\n            $(ReactDOM.findDOMNode(this)).find('input.expression-date-picker').datetimepicker({\n                format: 'YYYY-MM-DD',\n            }).on('dp.change', function(e) {\n                self.changeDate(e.date.format('YYYY-MM-DD'));\n            });\n        }\n    },\n    changeDate: function (date) {\n        this.props.expression.value = date;\n\n        this.props.changeValue({target:{value:date}});\n    },\n    componentDidMount: function() {\n        this.initializeJquery();\n    },\n    componentDidUpdate: function() {\n        this.initializeJquery();\n    },\n    render: function() {\n        var expression = this.props.expression;\n\n        var prototypes = this.props.prototypes.map(function(prototype, i) {\n            return (\n                <option key={i} value={prototype.key}>{prototype.name}</option>\n            )\n        }, this);\n\n        var prototype = this.props.prototypes.filter(function(item) {\n            return expression.key == item.key;\n        })[0];\n\n        if (!prototype) {\n            return <div />;\n        }\n\n        if (prototype.constraints && prototype.constraints.length > 0) {\n            var constraints = prototype.constraints.map(function(constraint, i) {\n                return (\n                    <option key={i} value={constraint.value}>{constraint.name}</option>\n                )\n            });\n        }\n\n        var nested, value, constraintSelect = null;\n\n        switch (prototype.type) {\n            case 'date':\n                value = <input type=\"text\" className=\"form-control expression-date-picker\" onChange={this.props.changeValue} value={this.props.expression.value}/>;\n                break;\n            case 'number':\n                value = <input type=\"number\" className=\"form-control\" onChange={this.props.changeValue} value={this.props.expression.value}/>;\n                break;\n            case 'select':\n                var choices = prototype.choices.map(function(choice, i) {\n                    return (\n                        <option key={i} value={choice.value}>{choice.name}</option>\n                    )\n                });\n                value = <select className=\"form-control\" onChange={this.props.changeValue} value={this.props.expression.value}>{choices}</select>;\n                break;\n            case 'text':\n                value = <input type=\"text\" className=\"form-control\" onChange={this.props.changeValue} value={this.props.expression.value}/>;\n                break;\n            default:\n                value = null;\n                break;\n        }\n\n        if (prototype.type == 'set') {\n            nested = <div className=\"form-group row\"><div className=\"col-xs-12\"><div className=\"p-l-lg\"><ExpressionBuilder changeChildren={this.props.changeChildren} prototypes={this.props.prototypes} expressions={expression.children} root={false} /></div></div></div>;\n            constraintSelect = '';\n        } else if (typeof(constraints) !== 'undefined' && constraints.length) {\n            constraintSelect = <select className=\"form-control\" onChange={this.props.changeConstraint} value={this.props.expression.constraint}>{constraints}</select>\n        }\n\n        return (\n            <div className=\"expression-constraint\">\n                <div className=\"form-group row\">\n                    <div className=\"col-xs-4 p-r-0\">\n                        <select className=\"form-control\" onChange={this.props.changePrototype} value={this.props.expression.key}>\n                            {prototypes}\n                        </select>\n                    </div>\n                    {constraintSelect ? <div className=\"col-xs-2 p-r-0\">{constraintSelect}</div> : null }\n                    {value ? <div className=\"col-xs-4 p-r-0\">{value}</div> : null}\n                    <div className=\"col-xs-2\">\n                        <a className=\"btn btn-link btn-sm\" onClick={this.props.remove}>\n                            <i className=\"material-icons md-18\">close</i>\n                        </a>\n                    </div>\n                </div>\n                {nested}\n            </div>\n        );\n    }\n});\n\nvar ExpressionBuilder = React.createClass({\n    getInitialState: function() {\n        return {\n            expressions: this.props.expressions,\n            prototypes: this.props.prototypes\n        };\n    },\n    updateExpressions: function(expressions) {\n        this.setState({expressions: expressions});\n        if (typeof(this.props.changeChildren) != 'undefined') {\n            this.props.changeChildren(expressions);\n        }\n    },\n    addExpression: function(event) {\n        var prototype = this.state.prototypes[0];\n\n        var expression = {\n            id: Date.now(),\n            key: prototype.key,\n            selector: prototype.selector,\n            constraint: (typeof(prototype.constraints) !== 'undefined' && prototype.constraints.length) ? prototype.constraints[0].value : '',\n            type: prototype.type,\n            value: (prototype.choices && prototype.choices.length > 0) ? prototype.choices[0].value : '',\n            children: []\n        };\n\n        var expressions = this.state.expressions.concat([expression]);\n        this.updateExpressions(expressions);\n    },\n    removeExpression: function(expression) {\n        var expressions = this.state.expressions.filter(function(item){\n            return expression.id !== item.id;\n        });\n\n        this.updateExpressions(expressions);\n    },\n    changeExpression: function(expression, event) {\n        var key = event.target.value;\n        var index = this.state.expressions.findIndex(function(item) {\n            return expression.id == item.id;\n        });\n\n        var prototype = this.state.prototypes.filter(function(item) {\n            return key == item.key;\n        })[0];\n\n        this.state.expressions[index].key = prototype.key;\n        this.state.expressions[index].selector = prototype.selector;\n        this.state.expressions[index].constraint = (prototype.constraints && prototype.constraints.length > 0) ? prototype.constraints[0].value : '';\n        this.state.expressions[index].type = prototype.type;\n        this.state.expressions[index].value = (prototype.choices && prototype.choices.length > 0) ? prototype.choices[0].value : '';\n\n        this.updateExpressions(this.state.expressions);\n    },\n    changeConstraint: function (expression, event) {\n        var constraint = event.target.value;\n        var index = this.state.expressions.findIndex(function(item) {\n            return expression.id == item.id;\n        });\n\n        this.state.expressions[index].constraint = constraint;\n        this.updateExpressions(this.state.expressions);\n    },\n    changeValue: function (expression, event) {\n        var value = event.target.value;\n        var index = this.state.expressions.findIndex(function(item) {\n            return expression.id == item.id;\n        });\n\n        this.state.expressions[index].value = value;\n        this.updateExpressions(this.state.expressions);\n    },\n    changeChildren: function (expression, children) {\n        var index = this.state.expressions.findIndex(function(item) {\n            return expression.id == item.id;\n        });\n\n        this.state.expressions[index].children = children;\n        this.updateExpressions(this.state.expressions);\n    },\n    render: function() {\n        var expressions = this.state.expressions.map(function(expression) {\n            return (\n                <Expression\n                    key={expression.id}\n                    expression={expression}\n                    prototypes={this.state.prototypes}\n                    changePrototype={this.changeExpression.bind(this, expression)}\n                    changeConstraint={this.changeConstraint.bind(this, expression)}\n                    changeValue={this.changeValue.bind(this, expression)}\n                    changeChildren={this.changeChildren.bind(this, expression)}\n                    remove={this.removeExpression.bind(this, expression)}>\n                </Expression>\n            )\n        }, this);\n\n        var input;\n        if (this.props.root == true) {\n            input = <input type=\"hidden\" name={this.props.input} value={JSON.stringify(this.state.expressions)} />;\n        }\n\n        var debug;\n        if (this.props.root == true && this.props.debug == true) {\n            debug = <div><pre>{JSON.stringify(this.state.expressions, null, 2) }</pre></div>;\n        }\n\n        return (\n            <div className=\"expression-builder\">\n                {input}\n                {expressions}\n                <a className=\"btn btn-default\" onClick={this.addExpression}>\n                    <i className=\"material-icons\">add</i> Add expression\n                </a>\n                {debug}\n            </div>\n        )\n    }\n});\n\nfunction initializeExpressionEngine() {\n    var container = document.getElementById('expressionbuilder');\n    if (container) {\n        ReactDOM.render(\n            <ExpressionBuilder\n                prototypes={JSON.parse(container.getAttribute('prototypes'))}\n                expressions={JSON.parse(container.getAttribute('expressions'))}\n                input={container.getAttribute('input')}\n                root={true}\n                debug={container.getAttribute('debug')}\n            />,\n            container\n        );\n    }\n}\n\ninitializeExpressionEngine();\n"]}